<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Police Investigation Typing - ฝึกพิมพ์งานสอบสวน</title>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-color: #1a1c1e;
            --main-color: #d4af37; /* สีทองแบบตราตำรวจ */
            --text-color: #7a7c7e;
            --sub-color: #e0e0e0;
            --error-color: #ff4b2b;
            --success-color: #2ecc71;
        }

        body {
            background-color: var(--bg-color);
            color: var(--sub-color);
            font-family: 'Sarabun', sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            margin: 0;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .header h1 { color: var(--main-color); margin-bottom: 5px; }
        .header p { color: var(--text-color); margin-top: 0; }

        #stats-container {
            display: flex;
            gap: 40px;
            margin-bottom: 25px;
            font-size: 1.1rem;
            background: rgba(255,255,255,0.05);
            padding: 15px 40px;
            border-radius: 50px;
            border: 1px solid rgba(212, 175, 55, 0.3);
        }

        .stat-box span { color: var(--main-color); font-weight: bold; font-family: monospace; font-size: 1.4rem; }

        #word-display {
            max-width: 850px;
            min-height: 150px;
            font-size: 24px;
            line-height: 1.8;
            margin-bottom: 30px;
            text-align: left;
            padding: 30px;
            background: #25282b;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            user-select: none;
            border-left: 5px solid var(--main-color);
        }

        .word {
            display: inline-block;
            margin-right: 10px;
            color: var(--text-color);
            transition: all 0.1s;
        }

        .word.active {
            color: var(--sub-color);
            background: rgba(212, 175, 55, 0.2);
            border-radius: 4px;
        }

        .word.correct { color: var(--success-color); }
        .word.incorrect { color: var(--error-color); text-decoration: underline; }

        #input-field {
            background: #ffffff;
            border: 3px solid transparent;
            border-radius: 8px;
            color: #1a1c1e;
            font-size: 24px;
            padding: 15px 25px;
            width: 500px;
            text-align: left;
            outline: none;
            font-family: 'Sarabun', sans-serif;
            transition: border-color 0.3s;
        }

        #input-field:focus { border-color: var(--main-color); }

        .controls { margin-top: 30px; display: flex; gap: 15px; }

        button {
            padding: 12px 25px;
            background: transparent;
            color: var(--main-color);
            border: 2px solid var(--main-color);
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            font-family: 'Sarabun', sans-serif;
            font-weight: bold;
            transition: all 0.3s;
        }

        button:hover {
            background: var(--main-color);
            color: #1a1c1e;
        }
    </style>
</head>
<body>

    <div class="header">
        <h1>ระบบฝึกพิมพ์สัมผัส งานสอบสวน</h1>
        <p>สำนักงานตำรวจแห่งชาติ (จำลอง)</p>
    </div>

    <div id="stats-container">
        <div class="stat-box">WPM: <span id="wpm">0</span></div>
        <div class="stat-box">ความแม่นยำ: <span id="accuracy">0</span>%</div>
    </div>
    
    <div id="word-display">กำลังเตรียมสำนวน...</div>

    <input type="text" id="input-field" placeholder="เริ่มพิมพ์ที่นี่ (กด Space เมื่อจบคำ)..." autofocus autocomplete="off">

    <div class="controls">
        <button onclick="newGame()">สุ่มคำให้การใหม่</button>
    </div>

    <script>
        // คลังประโยคงานสอบสวน
        const investigationArticles = [
            "พนักงานสอบสวนได้แจ้งข้อกล่าวหาให้ผู้ต้องหาทราบว่า การกระทำดังกล่าวเป็นความผิดฐานลักทรัพย์ในเคหสถาน",
            "ข้าพเจ้าขอให้การว่าตามวันเวลาที่เกิดเหตุ ข้าพเจ้าได้พักอาศัยอยู่ที่บ้านพักและไม่ได้ออกไปที่ใดเลย",
            "ผู้แจ้งประสงค์จะลงบันทึกประจำวันไว้เป็นหลักฐาน เพื่อนำไปประกอบการยื่นคำร้องต่อธนาคารต่อไป",
            "จากการตรวจสอบสถานที่เกิดเหตุ พบร่องรอยการงัดแงะที่บริเวณหน้าต่างทิศตะวันออกของตัวบ้าน",
            "เจ้าพนักงานตำรวจชุดจับกุมได้ทำการแจ้งสิทธิตามกฎหมายให้ผู้ถูกจับทราบครบถ้วนแล้ว",
            "ปรากฏตามสำนวนการสอบสวนว่า ผู้ต้องหาให้การรับสารภาพตลอดข้อกล่าวหาโดยความสมัครใจ",
            "พยานยืนยันว่าเห็นเหตุการณ์ขณะที่รถจักรยานยนต์คันดังกล่าวขับย้อนศรมาด้วยความเร็วสูง",
            "เจ้าพนักงานได้จัดทำบัญชีทรัพย์ถูกประทุษร้ายและแนบประกอบไว้ท้ายคำให้การนี้",
            "ในชั้นสอบสวนผู้ถูกจับให้การปฏิเสธทุกข้อกล่าวหาและประสงค์จะไปให้การในชั้นศาลเท่านั้น",
            "ร้อยเวรเจ้าของคดีได้นัดหมายให้คู่กรณีทั้งสองฝ่ายมาตกลงค่าเสียหายกันที่สถานีตำรวจ"
        ];

        const wordDisplay = document.getElementById('word-display');
        const inputField = document.getElementById('input-field');
        const wpmDisplay = document.getElementById('wpm');
        const accDisplay = document.getElementById('accuracy');

        let words = [];
        let currentWordIndex = 0;
        let startTime = null;
        let mistakes = 0;
        let totalWordsTyped = 0;

        function newGame() {
            const randomIndex = Math.floor(Math.random() * investigationArticles.length);
            const text = investigationArticles[randomIndex];
            
            words = text.split(' ');
            currentWordIndex = 0;
            startTime = null;
            mistakes = 0;
            totalWordsTyped = 0;
            
            inputField.value = '';
            wpmDisplay.innerText = '0';
            accDisplay.innerText = '0';
            
            renderWords();
        }

        function renderWords() {
            wordDisplay.innerHTML = '';
            words.forEach((word, index) => {
                const span = document.createElement('span');
                span.innerText = word;
                span.classList.add('word');
                span.id = `word-${index}`;
                wordDisplay.appendChild(span);
            });
            updateHighlight();
        }

        function updateHighlight() {
            document.querySelectorAll('.word').forEach(el => el.classList.remove('active'));
            const activeWord = document.getElementById(`word-${currentWordIndex}`);
            if (activeWord) {
                activeWord.classList.add('active');
            }
        }

        inputField.addEventListener('input', (e) => {
            if (!startTime) startTime = new Date();
            
            const typedValue = inputField.value;
            const currentWord = words[currentWordIndex];
            const activeWordSpan = document.getElementById(`word-${currentWordIndex}`);

            // เช็คเรียลไทม์
            if (!currentWord.startsWith(typedValue.trim())) {
                activeWordSpan.classList.add('incorrect');
            } else {
                activeWordSpan.classList.remove('incorrect');
            }

            // เมื่อกด Spacebar เพื่อเปลี่ยนคำ
            if (typedValue.endsWith(' ')) {
                const finalTyped = typedValue.trim();
                
                if (finalTyped === currentWord) {
                    activeWordSpan.className = 'word correct';
                    currentWordIndex++;
                    totalWordsTyped++;
                    inputField.value = '';
                    
                    if (currentWordIndex >= words.length) {
                        finishGame();
                    } else {
                        updateHighlight();
                    }
                } else {
                    mistakes++;
                    activeWordSpan.classList.add('incorrect');
                }
                calculateStats();
            }
        });

        function calculateStats() {
            const now = new Date();
            const timeDiff = (now - startTime) / 60000;
            const wpm = Math.round(currentWordIndex / timeDiff);
            const accuracy = Math.round(((totalWordsTyped - mistakes) / totalWordsTyped) * 100);
            
            wpmDisplay.innerText = wpm > 0 ? wpm : 0;
            accDisplay.innerText = accuracy > 0 ? accuracy : (totalWordsTyped === 0 ? 0 : 0);
        }

        function finishGame() {
            const timeTaken = ((new Date() - startTime) / 1000).toFixed(2);
            alert(`บันทึกคำให้การเสร็จสิ้น!\nเวลา: ${timeTaken} วินาที\nความเร็ว: ${wpmDisplay.innerText} WPM`);
            newGame();
        }

        newGame();
    </script>
</body>
</html>
